<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>大前端日常总结</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="iview踩坑总结菜单menu###【1】菜单里的active-name  | open-names不起作用  原因——直接给active-name  | open-names，却没有手动触发\$nextTick事件，就算你触发了这个事件，也不一定有作用，因为v-for遍历出来的的数组数据是异步获取回来的，所以在生命周期函数created或者mounted里触发\$nextTick事件的时间不对而">
<meta property="og:type" content="article">
<meta property="og:title" content="大前端日常总结">
<meta property="og:url" content="http://yoursite.com/2018/12/04/larval+h5踩坑总结 -/index.html">
<meta property="og:site_name" content="大前端日常总结">
<meta property="og:description" content="iview踩坑总结菜单menu###【1】菜单里的active-name  | open-names不起作用  原因——直接给active-name  | open-names，却没有手动触发\$nextTick事件，就算你触发了这个事件，也不一定有作用，因为v-for遍历出来的的数组数据是异步获取回来的，所以在生命周期函数created或者mounted里触发\$nextTick事件的时间不对而">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="c:/Users/admin/Desktop/1538202063(1">
<meta property="og:image" content="c:/Users/admin/Desktop/1538200972(1">
<meta property="og:image" content="c:/Users/admin/Desktop/input.png">
<meta property="og:image" content="c:/Users/admin/Desktop/form01.png">
<meta property="og:image" content="c:/Users/admin/Desktop/1538211938(1">
<meta property="og:image" content="c:/Users/admin/Desktop/upload.png">
<meta property="og:updated_time" content="2018-09-29T12:47:47.864Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大前端日常总结">
<meta name="twitter:description" content="iview踩坑总结菜单menu###【1】菜单里的active-name  | open-names不起作用  原因——直接给active-name  | open-names，却没有手动触发\$nextTick事件，就算你触发了这个事件，也不一定有作用，因为v-for遍历出来的的数组数据是异步获取回来的，所以在生命周期函数created或者mounted里触发\$nextTick事件的时间不对而">
<meta name="twitter:image" content="c:/Users/admin/Desktop/1538202063(1">
  
    <link rel="alternate" href="/atom.xml" title="大前端日常总结" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">大前端日常总结</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-larval+h5踩坑总结 -" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/04/larval+h5踩坑总结 -/" class="article-date">
  <time datetime="2018-12-04T08:23:16.928Z" itemprop="datePublished">2018-12-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="iview踩坑总结"><a href="#iview踩坑总结" class="headerlink" title="iview踩坑总结"></a>iview踩坑总结</h1><h2 id="菜单menu"><a href="#菜单menu" class="headerlink" title="菜单menu"></a>菜单menu</h2><p>###【1】菜单里的active-name  | open-names不起作用</p>
<ul>
<li>原因——直接给active-name  | open-names，却没有手动触发\$nextTick事件，就算你触发了这个事件，也不一定有作用，因为v-for遍历出来的<menuitem>的数组数据是异步获取回来的，所以在生命周期函数created或者mounted里触发\$nextTick事件的时间不对而导致active-name  | open-names显示不起作用</menuitem></li>
<li>解决方法——</li>
</ul>
<ol>
<li><p>给active-name  和 open-names一个初始值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;Menu ref=&quot;side_menu&quot; :theme=&quot;theme&quot; :style=&quot;changeW&quot; id=&quot;oul&quot; accordion </span><br><span class="line">      :open-names=&quot;openName&quot; :active-name=&quot;activeName&quot;  </span><br><span class="line">      @on-select=&quot;changeSelect&quot; @on-open-change=&quot;changeOpen&quot; &gt;</span><br><span class="line">      </span><br><span class="line">             &lt;Submenu v-for=&quot;item in menu&quot; :name=&quot;item.name&quot; :key=&quot;item.key&quot;&gt;</span><br><span class="line">                   &lt;template slot=&quot;title&quot; :style=&quot;changeW&quot;&gt;</span><br><span class="line">                        &lt;Icon :type=&quot;item.icons&quot;  :style=&quot;fz&quot;  @click=&quot;downup&quot;/&gt;</span><br><span class="line">                        &lt;span v-show=&quot;show&quot;&gt;&#123;&#123;item.name&#125;&#125;&lt;/span&gt;</span><br><span class="line">                   &lt;/template&gt;</span><br><span class="line">                   &lt;router-link v-for=&quot;son_item in item.children&quot; </span><br><span class="line">                   :to=&quot;&#123;&apos;name&apos;: son_item.name&#125;&quot; :key=&quot;son_item.key&quot;&gt;</span><br><span class="line">                         &lt;MenuItem :name=&quot;son_item.name&quot; v-show=&quot;show&quot;  v-text=&quot;son_item.name&quot;&gt;</span><br><span class="line">                         &lt;/MenuItem&gt;</span><br><span class="line">                    &lt;/router-link&gt;</span><br><span class="line">              &lt;/Submenu&gt;</span><br><span class="line">                    </span><br><span class="line">&lt;/Menu&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在获取到用于v-for遍历<menuitem>的数组this.menu之后，手动触发事件$nextTick</menuitem></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  initInfo () &#123;</span><br><span class="line">    this.$axios.get(this.testurl + &apos;/api/auth/left_menus&apos;).then((response) =&gt; &#123;</span><br><span class="line">      if (response.data.status === 1) &#123;</span><br><span class="line">        this.menu = response.data.data</span><br><span class="line">        </span><br><span class="line">        this.activeName=sessionStorage.getItem(&apos;activeName&apos;) || &apos;数据查询&apos;</span><br><span class="line">        this.openName=[sessionStorage.getItem(&apos;openName&apos;)] || [&apos;默认首页&apos;]</span><br><span class="line">        this.$nextTick(() =&gt; &#123;</span><br><span class="line">              this.$refs.side_menu.updateOpened()</span><br><span class="line">              this.$refs.side_menu.updateActiveName()</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>动态更新active-name  | open-names的状态值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  changeOpen (name) &#123;</span><br><span class="line">    sessionStorage.setItem(&apos;openName&apos;,name)</span><br><span class="line">  &#125;,</span><br><span class="line">  changeSelect (name) &#123;</span><br><span class="line">    sessionStorage.setItem(&apos;activeName&apos;,name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="C:\Users\admin\Desktop\1538202063(1" alt="1538202063(1)">.png)</p>
<p>###【2】嵌套<menuitem>的 <router-link>里的to属性一直报错</router-link></menuitem></p>
<ul>
<li>这里<menuitem>是由数组v-for遍历出来的，我尝试过改变数据获取的时间，或者把item.router由字符串‘/home/gamlist’改为对象{‘name’: son_item.name},结果都没有成功，幸运的是，我在尝试了各种方法之后，终于找到了解决方法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link v-for=&quot;son_item in item.children&quot; :to=&quot;&#123;&apos;name&apos;: son_item.name&#125;&quot; :key=&quot;son_item.key&quot;&gt;</span><br><span class="line">     &lt;MenuItem :name=&quot;son_item.name&quot; v-show=&quot;show&quot;  v-text=&quot;son_item.name&quot;&gt;</span><br><span class="line">     &lt;/MenuItem&gt;</span><br><span class="line">&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
</menuitem></li>
</ul>
<h2 id="表格table"><a href="#表格table" class="headerlink" title="表格table"></a>表格table</h2><p>###【1】动态改变常态栏或操作栏里的文本</p>
<ul>
<li>直接在render里操作即可，看情况修改<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">columns: [</span><br><span class="line">        &#123;</span><br><span class="line">          title: &apos;操作人&apos;,</span><br><span class="line">          key: &apos;admin&apos;,</span><br><span class="line">          render (h,params)&#123;//改变文本内容</span><br><span class="line">            return h(&apos;span&apos;, params.row.admin === null ? &apos;&apos; : params.row.admin.name)</span><br><span class="line">          &#125; </span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          title: &apos;操作&apos;,</span><br><span class="line">          key: &apos;action&apos;,</span><br><span class="line">          fixed: &apos;right&apos;,//一直右浮动</span><br><span class="line">          render: (h, params) =&gt; &#123;</span><br><span class="line">            return h(&apos;div&apos;, [</span><br><span class="line">              h(&apos;Button&apos;, &#123;</span><br><span class="line">                props: &#123;</span><br><span class="line">                  type: params.row.status === 0 ? &apos;success&apos; : &apos;error&apos;,//改变按钮颜色</span><br><span class="line">                  size: &apos;small&apos;</span><br><span class="line">                &#125;,</span><br><span class="line">                style: &#123;</span><br><span class="line">                  marginRight: &apos;5px&apos; //这里可以直接操作按钮的样式</span><br><span class="line">                &#125;,</span><br><span class="line">                on: &#123;</span><br><span class="line">                  click: () =&gt; &#123;</span><br><span class="line">                    this.changeStatus(params)</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;, params.row.status === 0 ? &apos;发布&apos; : &apos;冻结&apos;)//改变按钮的文本内容</span><br><span class="line">            ])</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="C:\Users\admin\Desktop\1538200972(1" alt="1538200972(1)">.png)</p>
<h3 id="【2】批量处理表格的数据"><a href="#【2】批量处理表格的数据" class="headerlink" title="【2】批量处理表格的数据"></a>【2】批量处理表格的数据</h3><ul>
<li>解决思路，先获取多选和全选的数据，然后发送请求，请求成功后，再改变表格中被选中的状态值</li>
</ul>
<ol>
<li>添加多选和全选的事件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button type=&quot;primary&quot; @click=&quot;batchOperate(1)&quot; class=&quot;btn&quot; size=&quot;large&quot;&gt;批量发布&lt;/Button&gt;</span><br><span class="line">&lt;Button type=&quot;primary&quot; @click=&quot;batchOperate(0)&quot; class=&quot;btn&quot; size=&quot;large&quot;&gt;批量冻结&lt;/Button&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;Table border ref=&quot;selection&quot; :columns=&quot;columns&quot; :data=&quot;tableData&quot; :loading=&quot;loading&quot; </span><br><span class="line">@on-select-all=&quot;selectAll&quot;  @on-selection-change=&quot;select&quot; class=&quot;tableBox&quot;&gt;&lt;/Table&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    select (row) &#123;</span><br><span class="line">      console.log(row)</span><br><span class="line">      this.rowArray = row</span><br><span class="line">    &#125;,</span><br><span class="line">    selectAll (all) &#123;</span><br><span class="line">      this.rowArray = all</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>获取多选或全选的数据，然后发送请求，再改变表格中被选中的状态值<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">batchOperate(status)&#123; //批量发布/冻结</span><br><span class="line">  this.ids = []</span><br><span class="line">  //获取批量的id</span><br><span class="line">  for (let i = 0; i &lt; this.rowArray.length; i++) &#123;</span><br><span class="line">    if(status === 0 &amp;&amp; this.rowArray[i].status === 1)&#123;</span><br><span class="line">      this.ids.push(this.rowArray[i].id)</span><br><span class="line">    &#125;else if(status === 1 &amp;&amp; this.rowArray[i].status === 0)&#123;</span><br><span class="line">      this.ids.push(this.rowArray[i].id)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if(this.ids.length &gt; 0)&#123;//校验有选择的时候才发送请求</span><br><span class="line">    this.$axios.post(this.testurl + &apos;/api/games/batch&apos;, &#123;</span><br><span class="line">      _method: &apos;PUT&apos;,</span><br><span class="line">      ids: this.ids,</span><br><span class="line">      status: status</span><br><span class="line">    &#125;).then((response) =&gt; &#123;</span><br><span class="line">      if(response.data.status === 1)&#123;</span><br><span class="line">      //通过改变tableData来改变表格的状态值</span><br><span class="line">        this.tableData = this.tableData.map((row) =&gt; &#123;</span><br><span class="line">          this.rowArray.map((item) =&gt; &#123;</span><br><span class="line">            if(item.id === row.id)&#123;</span><br><span class="line">              row.status = status</span><br><span class="line">            &#125;</span><br><span class="line">            return item</span><br><span class="line">          &#125;)</span><br><span class="line">          return row</span><br><span class="line">        &#125;)</span><br><span class="line">        //由于rowArray的地址指向跟函数select里的row和函数selectAll里的all一样，</span><br><span class="line">        //所以清空rowArray，就可以把表格上的钩去掉</span><br><span class="line">        this.rowArray = []</span><br><span class="line">        this.$Message.success(status === 1 ? &apos;批量发布成功！&apos; : &apos;批量冻结成功！&apos;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="【3】表格操作栏的按钮事件里this指向丢失了"><a href="#【3】表格操作栏的按钮事件里this指向丢失了" class="headerlink" title="【3】表格操作栏的按钮事件里this指向丢失了"></a>【3】表格操作栏的按钮事件里this指向丢失了</h3><ul>
<li><p>不用多想了，官方文档没毛病，肯定是你复制了百度人家的错误代码，以下是错误案例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">columns: [</span><br><span class="line">  &#123;</span><br><span class="line">    title: &apos;操作&apos;,</span><br><span class="line">    key: &apos;action&apos;,</span><br><span class="line">    render(h, params)&#123; //这里可不是你展现ES6简写的时候</span><br><span class="line">      return h(&apos;div&apos;, [</span><br><span class="line">        h(&apos;Button&apos;, &#123;</span><br><span class="line">          on: &#123;</span><br><span class="line">            click: () =&gt; &#123; console.log(this) &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, &apos;编辑&apos;),</span><br><span class="line">      ])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
</li>
<li><p>好了，再对比一下正确的官方文档吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">columns: [</span><br><span class="line">  &#123;</span><br><span class="line">    title: &apos;操作&apos;,</span><br><span class="line">    key: &apos;action&apos;,</span><br><span class="line">    render: (h, params)=&gt;&#123; //这里可不是你展现ES6简写的时候</span><br><span class="line">      return h(&apos;div&apos;, [</span><br><span class="line">        h(&apos;Button&apos;, &#123;</span><br><span class="line">          on: &#123;</span><br><span class="line">            click: () =&gt; &#123; console.log(this) &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, &apos;编辑&apos;),</span><br><span class="line">      ])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>###【4】只能导出当前表格里的数据</p>
<ul>
<li>我们有时候会出现 一个需要，导出数据库里所有的数据，但是前端页面却只显示第一页的数据，这时候我建议直接后端返回<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exportData () &#123;</span><br><span class="line">  var url = this.testurl + &apos;/api/statistics/summary/csv?&apos; +  &apos;&amp;token=&apos; + this.token</span><br><span class="line">  window.open(url)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>##选择器Select </p>
<p>###【1】v-model对应的值跟上面输入搜索的值不一致</p>
<ul>
<li>给选择器添加搜索功能的时候，你会发现，必须要选择下拉目录下的任意一个，要不然它的v-model对应的值跟上面输入搜索的值不一致，input输入框上面你显示的值要么为你输入的内容，要么你上一次选中的下拉目录中的值 ，（不好意思，这个坑我也拿它没有办法）</li>
</ul>
<p>##分页器page</p>
<p>###【1】当前页码的激活状态current不起作用</p>
<ul>
<li>这个很简单，官方文档有提示，只是你不知道怎么加上 .sync 修饰符而已<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Page :page-size=&quot;this.pageSize&quot; :total=&quot;this.total&quot; show-elevator :current.sync=&quot;current&quot; /&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>##输入框input</p>
<p>###【1】阻止浏览器自动回填邮箱和密码</p>
<ul>
<li>一般浏览器都自带着是否保留账号/邮箱和密码的功能，在你登录成功后，浏览器就会记得你的账号/邮箱和密码，就会回填到input里</li>
<li>解决方法——<blockquote>
<p>  有时候你会发现，就算加了autocomplete=”off” 也不起作用，那是因为谷歌不兼容autocomplete,这时间要多加几个属性   :spellcheck=’check’   name=”TPL_password”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//文本输入框</span><br><span class="line">&lt;Input type=&quot;text&quot; v-model=&quot;user&quot; style=&quot;width: auto&quot; size=&quot;large&quot;  autocomplete=&quot;off&quot; :spellcheck=&apos;check&apos;&gt;</span><br><span class="line">&lt;/Input&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//密码输入框</span><br><span class="line">&lt;Input type=&quot;password&quot; v-model=&quot;password&quot; style=&quot;width: auto&quot; size=&quot;large&quot; autocomplete=&quot;off&quot; :spellcheck=&apos;check&apos; name=&quot;TPL_password&quot;&gt;</span><br><span class="line">&lt;/Input&gt;</span><br></pre></td></tr></table></figure>
<p><img src="C:\Users\admin\Desktop\input.png" alt="input"></p>
<p>###【2】如何限制输入多少位手机号码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Input v-model=&quot;formItem.phone&quot; :maxlength=&quot;11&quot;&gt;&lt;/Input&gt;</span><br></pre></td></tr></table></figure>
<p>##表单form<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;Form ref=&quot;formItem&quot; :model=&quot;formItem&quot; :rules=&quot;ruleInline&quot; :label-width=&quot;100&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;FormItem label=&quot;密码&quot; prop=&quot;password&quot;&gt;</span><br><span class="line">        &lt;Input type=&quot;password&quot; v-model=&quot;formItem.password&quot; &gt;&lt;/Input&gt;</span><br><span class="line">    &lt;/FormItem&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;FormItem label=&quot;邮箱&quot; prop=&quot;email&quot;&gt;</span><br><span class="line">        &lt;Input v-model=&quot;formItem.email&quot; &gt;&lt;/Input&gt;</span><br><span class="line">    &lt;/FormItem&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;FormItem label=&quot;手机&quot; prop=&quot;phone&quot;&gt;</span><br><span class="line">        &lt;Input v-model=&quot;formItem.phone&quot; :maxlength=&quot;11&quot;&gt;&lt;/Input&gt;</span><br><span class="line">    &lt;/FormItem&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;FormItem&gt;</span><br><span class="line">        &lt;Button type=&quot;primary&quot; @click=&quot;handleSubmit(&apos;formItem&apos;)&quot;&gt;确认&lt;/Button&gt;</span><br><span class="line">        &lt;Button @click=&quot;handleReset(&apos;formItem&apos;)&quot;&gt;重置&lt;/Button&gt;</span><br><span class="line">    &lt;/FormItem&gt;</span><br><span class="line">&lt;/Form&gt;</span><br></pre></td></tr></table></figure></p>
<p>###【1】rules如何校验邮箱、密码、手机号码（结合正则）</p>
<ul>
<li><p>ruleInline只是对填写内容的初步检验</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    ruleInline: &#123;</span><br><span class="line">      password: [</span><br><span class="line">        &#123; required: true, message: &apos;密码不能为空&apos;, trigger: &apos;blur&apos; &#125;,</span><br><span class="line">        &#123; type: &apos;string&apos;, min: 6, message: &apos;密码的长度不能小于6位&apos;, trigger: &apos;blur&apos; &#125;</span><br><span class="line">      ],</span><br><span class="line">      email: [</span><br><span class="line">          &#123; required: true, message: &apos;邮箱不能为空&apos;, trigger: &apos;blur&apos; &#125;,</span><br><span class="line">          &#123; type: &apos;email&apos;, message: &apos;邮箱格式不正确&apos;, trigger: &apos;blur&apos; &#125;</span><br><span class="line">      ],</span><br><span class="line">      phone: [</span><br><span class="line">        &#123; required: true, message: &apos;手机码不能为空&apos;, trigger: &apos;blur&apos; &#125;,</span><br><span class="line">        &#123; type: &apos;string&apos;,min: 11, max: 11, message: &apos;手机码格式不正确&apos;, trigger: &apos;blur&apos; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>建义结合正则来校验邮箱、密码、手机号码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">handleSubmit (name) &#123;</span><br><span class="line">    this.$refs[name].validate((valid) =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">            //正则匹配手机号码</span><br><span class="line">            if (/^1[34578][0-9]&#123;9&#125;$/.test(this.formItem.phone)) &#123;</span><br><span class="line">                //手机格式正确，接下来这里发送请求</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                this.$Message.error(&apos;手机格式不正确&apos;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            this.$Message.error(&apos;请填写完整&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>###【2】选择器在可多选的时候选择了，却被rules校验到内容为空</p>
<ul>
<li>这是因为选择器的v-model值 role_ids默认为一个数组，但是ruleInline校验的却认为它应该是一个字符串，所以只需要在修改之前转用JSON.stringify换一下它的格式就行了,别忘记了在校验成功或失败之后把它的格式用JSON.parse再转换回来哟<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ruleInline: &#123;</span><br><span class="line">  role_ids: [</span><br><span class="line">    &#123; required: true, message: &apos;角色不能为空&apos;, trigger: &apos;blur&apos;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">handleSubmit (name) &#123;</span><br><span class="line">    this.formItem.role_ids =  JSON.stringify(this.formItem.role_ids)</span><br><span class="line">    this.$refs[name].validate((valid) =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">            this.formItem.role_ids =  JSON.parse(this.formItem.role_ids)</span><br><span class="line">            //接下来这里发送请求</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            this.formItem.role_ids = JSON.parse(this.formItem.role_ids)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="C:\Users\admin\Desktop\form01.png" alt="form01"></p>
<p>###【3】重置回填只有在首次有效，第二次无效</p>
<ul>
<li>因为备份的重置数据的地址直接赋值给表单v-model的值，这时候需要深拷贝，以下有3种方法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;Form ref=&quot;formItem&quot; :model=&quot;formItem&quot; :rules=&quot;ruleInline&quot;&gt;</span><br><span class="line">    &lt;FormItem label=&quot;角色组名&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">        &lt;Input v-model=&quot;formItem.name&quot;&gt;&lt;/Input&gt;</span><br><span class="line">    &lt;/FormItem&gt;</span><br><span class="line">    &lt;FormItem&gt;</span><br><span class="line">        &lt;Button @click=&quot;handleReset(&apos;formItem&apos;)&quot; &gt;重置&lt;/Button&gt;</span><br><span class="line">    &lt;/FormItem&gt;</span><br><span class="line">&lt;/Form&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>  注意：方法1 要事先把reset通过深拷贝一次<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//方法1：直接遍历深拷贝</span><br><span class="line">methods: &#123;</span><br><span class="line">    handleReset (name) &#123;</span><br><span class="line">        for(let key in this.reset) &#123;</span><br><span class="line">            this.formItem[key] = this.reset[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>  注意：方法2 要事先把reset通过深拷贝一次<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//方法2：如果是数组，可以用concant（不推荐——因为不能对它里面嵌套的数组/对象里进行深拷贝）</span><br><span class="line">methods: &#123;</span><br><span class="line">    handleReset (name) &#123;</span><br><span class="line">        this.formItem = this.formItem.concat(this.reset)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>  注意：方法3要事先把reset通过JSON.stringify( )转化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//方法3：转化成JSON数据</span><br><span class="line">methods: &#123;</span><br><span class="line">    handleReset (name) &#123;</span><br><span class="line">        this.formItem = JSON.parse(this.reset)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="C:\Users\admin\Desktop\1538211938(1" alt="1538211938(1)">.png)</p>
<p>##上传upload</p>
<p>###【1】表单里包含有文件上传</p>
<ul>
<li><p>思路：先选择加载上传图片，上传成功之后，再把图片发送请求到腾讯云，然后把拿回来的地址跟其他的表单内容合并一起，再POST请求</p>
<p><img src="C:\Users\admin\Desktop\upload.png" alt="upload"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;Form ref=&quot;formValidate&quot; :model=&quot;formData&quot; :rules=&quot;ruleValidate&quot; :label-width=&quot;120&quot;&gt;</span><br><span class="line">&lt;FormItem label=&quot;游戏图标&quot; prop=&quot;logo&quot;&gt;</span><br><span class="line">	&lt;Upload</span><br><span class="line">		:action=&quot;uploadPath&quot;</span><br><span class="line">		:format=&quot;[&apos;jpg&apos;,&apos;jepg&apos;,&apos;png&apos;,&apos;bmp&apos;,&apos;gif&apos;,&apos;svg&apos;]&quot;</span><br><span class="line">		:before-upload=&quot;handleUpload&quot;//	上传文件之前的钩子</span><br><span class="line">		:on-format-error=&quot;handleFormatError&quot;//文件格式验证失败时的钩子</span><br><span class="line">		:on-error=&quot;uploadError&quot; //文件上传成功时的钩子</span><br><span class="line">		:on-success=&quot;handleSuccess&quot;//文件上传成功时的钩子，返回字段为 response, file, fileList</span><br><span class="line">		ref=&quot;upload&quot;&gt;</span><br><span class="line">		&lt;Button icon=&quot;ios-cloud-upload-outline&quot;&gt;上传文件&lt;/Button&gt;</span><br><span class="line">		&lt;span v-if=&quot;file !== null&quot; style=&quot;margin-left:10px;&quot;&gt;&#123;&#123; file.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">	&lt;/Upload&gt;</span><br><span class="line">	&lt;span style=&quot;color:#f00;&quot;&gt;请上传分辨率大小为512*512的图片（.jpg,.jpeg,.png,.bmp,.gif,.svg）&lt;/span&gt;</span><br><span class="line">&lt;/FormItem&gt;</span><br><span class="line">&lt;FormItem&gt;</span><br><span class="line">	&lt;Button type=&quot;primary&quot; @click=&quot;handleSubmit(&apos;formValidate&apos;)&quot;&gt;确认&lt;/Button&gt;</span><br><span class="line">&lt;/FormItem&gt;</span><br><span class="line">&lt;/Form&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   //1.0确认后执行校验</span><br><span class="line">   handleSubmit (form) &#123;</span><br><span class="line">       this.$refs[form].validate((valid) =&gt; &#123;</span><br><span class="line">           if (valid) &#123;</span><br><span class="line">if(this.file === null)&#123;</span><br><span class="line">       			this.$Message.info(&quot;请选择游戏图标&quot;)</span><br><span class="line">	return</span><br><span class="line">&#125;</span><br><span class="line">this.uploadFile()	//上传图片</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">     //2.0上传图片</span><br><span class="line">     uploadFile () &#123;</span><br><span class="line">this.uploadPath = this.testurl + &apos;/api/upload/local/icon?token=&apos; + this.token</span><br><span class="line">         setTimeout(() =&gt; &#123;</span><br><span class="line">              //触发上传事件</span><br><span class="line">	this.$refs.upload.post(this.file)</span><br><span class="line">         &#125;, 1000)</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//3.0发送请求</span><br><span class="line">handleSuccess(response)&#123;</span><br><span class="line">	this.formData.logo = response.data.url</span><br><span class="line">	this.$axios.post(this.testurl + &apos;/api/games/&apos;, &#123;</span><br><span class="line">		logo: this.file.name</span><br><span class="line">	&#125;).then((response) =&gt; &#123;</span><br><span class="line">		if(response.data.status === 1)&#123;</span><br><span class="line">			this.$Message.success(&apos;新增游戏成功！&apos;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;).catch((err) =&gt; &#123;</span><br><span class="line">	&#125;)</span><br><span class="line">	//重置清空上传的状态</span><br><span class="line">	this.$refs.upload.clearFiles()</span><br><span class="line">	this.file = null</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/04/larval+h5踩坑总结 -/" data-id="cjpc242nk0002ygat7e9urqfi" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/12/04/iview踩坑总结/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2018/12/04/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/12/04/iview踩坑总结/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/12/04/larval+h5踩坑总结 -/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/12/04/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 飞天女猪侠<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>